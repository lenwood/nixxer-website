<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    if (typeof mermaid !== 'undefined') {
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
        
        // Find all code blocks with mermaid class and convert them
        const codeBlocks = document.querySelectorAll('pre code.language-mermaid, code.language-mermaid');
        
        codeBlocks.forEach((codeBlock) => {
            const content = codeBlock.textContent;
            
            // Create a new div for the mermaid diagram
            const mermaidDiv = document.createElement('div');
            mermaidDiv.className = 'mermaid';
            mermaidDiv.textContent = content;
            
            // Replace the code block with the mermaid div
            const preElement = codeBlock.closest('pre') || codeBlock;
            preElement.parentNode.replaceChild(mermaidDiv, preElement);
        });
        
        // Render all mermaid diagrams
        mermaid.run();
    }
});
</script>